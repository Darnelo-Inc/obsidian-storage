**tcpdump** — это сетевой анализатор трафика для работы из командной строки в Linux/UNIX. Он позволяет перехватывать, отслеживать и анализировать сетевой трафик, проходящий через сетевые интерфейсы компьютера.

---
## Для чего используется tcpdump?

- Диагностика сетевых проблем: например, выявление, проходят ли пакеты, как выглядят запросы и ответы.
- Анализ сетевой активности (отладка приложений, безопасность).
- Ловля подозрительных соединений или вредоносного трафика.
- Изучение работы сетевых протоколов (TCP, UDP, ICMP и др.).
- Запись лога трафика для последующего анализа.

---
## Базовый синтаксис

`tcpdump [опции] [фильтр]`

*Обычно нужны права root или sudo для прямого доступа к сетевым интерфейсам.*

---
## Основные примеры использования

### Захват пакетов с интерфейса eth0

`tcpdump -i eth0`

### Смотреть только HTTP (порт 80)

`tcpdump -i eth0 port 80`

### Смотреть только исходящий трафик:

`tcpdump -i eth0 outbound`

### Смотреть только ICMP (ping)

`tcpdump icmp`

### Фильтрация по IP-адресу

`tcpdump host 192.168.1.10`

### Фильтрация по протоколу и порту (например, UDP/53 — DNS)

`tcpdump udp port 53`

### Сохранять трафик в файл для анализа (например, в Wireshark)

`tcpdump -i eth0 -w traffic.pcap`

### Читать сохранённый дамп:

`tcpdump -r traffic.pcap`

---

## Краткая справка по ключам

- -i — выбрать сетьвой интерфейс (например, eth0, enp0s3, lo и т.д.)
- -n — **не** пытаться разрешить адреса в имена (выведет чистые IP)
- -v, -vv, -vvv — уровень детализации вывода
- -c N — остановиться после захвата N пакетов
- -w file.pcap — записать дамп в файл (pcap-формат)
- -r file.pcap — читать из файла дампа
- -A — выводить содержимое пакетов в ASCII (для анализа http, smtp и т.п.)

---
## Основы фильтрации

Фильтры задаются прямо в командной строке. Можно комбинировать условия через and, or, not:

**По IP:** src, dst
  - Пример: src 10.0.0.1
**По порту:** port 443, src port 53
**По протоколу:** tcp, udp, icmp
**Комбинации:**  
  tcp port 443 and src 1.2.3.4

Пример сложной фильтрации:

sudo tcpdump -i eth0 tcp port 443 and src 1.2.3.4

```bash
#!/usr/bin/env bash

exec 3<>/dev/tcp/ya.ru/80

lines=(
        'GET /ping HTTP/1.1'
        'Host: ya.ru'
        'Connection: close'
        ''
)

printf '%s\r\n' "${lines[@]}" >&3

while read -r data <&3; do
        echo "got server data: $data"
done

exec 3>&-
```

#!/usr/bin/env bash

Это shebang, указывающий, что скрипт нужно выполнять через интерпретатор bash (который будет найден через env). Подробнее о shebang ты спрашивал выше.

---

exec 3<>/dev/tcp/ya.ru/80

- Открывает двусторонний (чтение и запись) файловый дескриптор с номером 3 для работы с сетевым соединением.
- /dev/tcp/ya.ru/80 — это специальное "виртуальное" устройство в Bash, позволяющее соединяться с хостом **ya.ru** по порту **80** (HTTP).
- После этого дескриптор 3 (&3) можно использовать подобно файлу: писать данные на сервер и читать от него.
---

lines=(
        'GET /ping HTTP/1.1'
        'Host: ya.ru'
        'Connection: close'
        ''
)

- Объявляется массив **lines**.
- В него помещаются строки, составляющие HTTP-запрос:
  - 'GET /ping HTTP/1.1' — запрашиваем адрес /ping по протоколу HTTP/1.1 методом GET.
  - 'Host: ya.ru' — обязательный HTTP-заголовок "Host", указывает серверу целевой домен.
  - 'Connection: close' — заголовок, говорящий серверу закрыть соединение после ответа.
  - '' — пустая строка, означает конец HTTP-заголовков (требование протокола HTTP).

---
#### Отправка запроса серверу

printf '%s\r\n' "${lines[@]}" >&3

- printf '%s\r\n' ... — печатает каждую строку из массива lines.
- \r\n — это перевод строки в формате протокола HTTP (carriage return + line feed).
- "${lines[@]}" — подставляет каждую строку массива как отдельный параметр.
- >&3 — перенаправляет вывод (STDOUT) в файловый дескриптор 3, то есть в открытое TCP-соединение с сервером **ya.ru** на порту 80.

---
#### Получение ответа из сокета

while read -r data <&3; do
        echo "got server data: $data"
done

- while read -r data <&3; do ... done — читает данные строчка за строчкой из дескриптора 3 (то есть из TCP-соединения с сервером).
- В цикле каждая полученная строка выводится на экран с префиксом "got server data: ".

---
#### Закрытие соединения

exec 3>&-

- Эта команда закрывает файловый дескриптор 3. Это завершает TCP-соединение.

---
## Итог

**Вся программа делает следующее:**

1. Устанавливает TCP-соединение с сервером ya.ru по HTTP-порту 80.
2. Отправляет простейший GET-запрос к адресу /ping с нужными заголовками.
3. Получает и построчно выводит ответ сервера.
4. Закрывает соединение.

---
###### Источники:

- Youtube [Making an HTTP request in Bash without `curl` or `wget`](https://youtu.be/tSoFTD9Y8UU?si=be-ZdP8_o1LXAAfc)

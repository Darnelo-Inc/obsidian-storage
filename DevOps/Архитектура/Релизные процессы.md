### Recreate

- Что это: останавливаем старую версию, затем запускаем новую.
- Как работает: стоп всего пула → деплой → старт. Есть простой «даунтайм».
- Плюсы: максимально просто; нет одновременной работы разных версий → не нужно думать о совместимости на уровне трафика.
- Минусы: простои, риск «всё или ничего», сложный откат (ещё один recreate).
- Когда применять: небольшие сервисы, допустимо окно недоступности; внутренняя админка; крупные несовместимые изменения.
- Инструменты: Kubernetes strategy=Recreate; systemd/ansible/ssh-скрипты; maintenance window.
  

### Rolling update

- Что это: поочередная замена инстансов на новую версию.
- Как работает: постепенно добавляем новые и убираем старые (k8s: maxSurge/maxUnavailable).
- Плюсы: почти без даунтайма, встроено в оркестраторы.
- Минусы: одновременно живут 2 версии → нужны обратная/прямая совместимость; длинные релизы сложнее мониторить/откатывать.
- Когда применять: типовой веб/API, где важна доступность; совместимые миграции БД (expand–migrate–contract).
- Инструменты: Kubernetes Deployments (RollingUpdate), ASG в AWS, connection draining на LB.


### Blue‑green

- Что это: держим 2 полноценные среды — Blue (prod) и Green (новая). Переключаем трафик «рубильником».
- Как работает: поднимаем Green параллельно, прогреваем, переключаем маршрутизацию; откат — вернуть на Blue.
- Плюсы: минимальный даунтайм; быстрый, безопасный откат; возможность прогрева/миграций заранее.
- Минусы: вдвое больше ресурсов на период релиза; сложнее со состоянием (сессии, очереди, БД).
- Когда применять: критичные к простоям сервисы; когда хотим «атомное» переключение и быстрый откат.
- Инструменты: отдельные версии сервисов/стеков; переключение через LB/Ingress/DNS; в k8s — две версии + смена Service/Ingress; Argo Rollouts (blueGreen), Spinnaker, AWS CodeDeploy Blue/Green.
  

### Canary

- Что это: сначала небольшой процент трафика на новую версию, далее доли растут при нормальных метриках.
- Как работает: 1% → 5% → 25% → 50% → 100% с автоматическими проверками и возможностью автоотката.
- Плюсы: минимизация риска; раннее обнаружение регрессий на реальном трафике; тонкая градация.
- Минусы: сложнее настройка маршрутизации и метрик; дольше релиз; нужны строгие SLO и алерты.
- Когда применять: высоконагруженные/критичные сервисы; гипотезы производительности/стабильности.
- Инструменты: сервис‑мэш/ингресс с взвешиванием трафика (Istio, Linkerd, NGINX, Traefik), Argo Rollouts, Flagger, AWS ALB weighted target groups, Cloudflare/Route53 weighted DNS.


#### Общие практики независимо от стратегии

- Мониторинг и гейты: error rate, latency, saturation, SLO; автоматический стоп/откат при деградации.
- Совместимость схем БД: стратегия expand–migrate–contract, миграции, совместимость N и N−1.
- Состояние: внешние сессии (Redis), connection draining, прогрев кэшей.
- Feature flags: отделяйте деплой от активации функциональности; поддерживают dark‑launch и A/B.
- Откаты: планируйте быстрый rollback в ту же стратегию (для blue‑green — мгновенное переключение; для canary/rolling — rollback на предыдущий ReplicaSet/артефакт).


#### Короткий выбор стратегии

- Нужна простота и можно с даунтаймом → Recreate.
- Нужен нулевой/минимальный даунтайм без сложной маршрутизации → Rolling update.
- Нужен быстрый «рубильник» и гарантированный откат → Blue‑green.
- Максимальная осторожность и поэтапная проверка на проде → Canary.